<!DOCTYPE HTML>

<html lang='en'>
	<head>
		<title>Integration Testing a Typescript Lambda API using Jest (&amp; Supertest) &middot; Simon Gilbert</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		
		
		
		<link rel="stylesheet" href="/assets/css/main.min.css">
		
		
		<link rel="shortcut icon" href="/favicon.ico">
		
		
		<noscript><link rel="stylesheet" href='/assets/css/noscript.css' /></noscript>

		
    		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-136163864-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  		
	</head>

	<body lang='en' class="is-preload">

		
			<div id="wrapper">

                
<header id="header">
    <a href='/' class="logo">Simon Gilbert</a>
</header>

                

<nav id="nav">
    <ul class="links">
        <li class="active"><a href='/'>Home</a></li>
        
        
    </ul>
    
    <ul class="icons">
        
        
        
        
        
        <li><a href="https://github.com/sahgilbert" class="icon fa-github"><span class="label">GitHub</span></a></li>
        
        
        
        
        
    </ul>
    
</nav>


				
					<div id="main">

						
                        <section class="post">
                            <header class="major">
                                
                                <span class="date">July 14, 2020</span>
                                
                                <h1>Integration Testing a Typescript Lambda API using Jest (&amp; Supertest)</h1>
                                <p></p>
                            </header>
                            
                            <div class="image main"><img src="/images/2020/08/Screenshot-2020-08-16-at-18.06.33.png" alt="" /></div>
                            
                            <p>Integration Testing is a level of software testing where individual units are combined and tested as a group. The purpose of this level of testing is to expose faults in the interaction between integrated units. Today we&rsquo;re going to look at doing Integration Testing using Jest and Supertest.</p>
<h3 id="what-is-jest">What is Jest?</h3>
<p>Jest is a JavaScript Testing Framework with a focus on simplicity. One thing I particularly like about Jest is that it aims to work out of the box, config free, which is always a joy rather than having to spend ages configuring your testing framework! Interestingly, to make things quick Jest runs previously failed tests first and re-organizes runs based on how long test files take.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.36.05.png"/>
</figure>

<h3 id="lets-code">Let&rsquo;s Code&hellip;</h3>
<p>I&rsquo;m going to assume that you already under AWS Lambda functions and API Gateway. Today I&rsquo;ll be using my WIP phone number api codebase to demo Jest, and writing our integration tests in Javascript.The first thing to do is install <strong>Jest</strong> and <strong>Supertest</strong>.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.38.43.png"/>
</figure>

<p>Next, create a directory in your root folder called &ldquo;<strong><strong>tests</strong></strong>&rdquo;.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.39.26.png"/>
</figure>

<p>Within that directory create another folder called &ldquo;integration&rdquo;.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.41.15.png"/>
</figure>

<p>Now create a Javascript file that includes the name of the lambda function that we are writing integration tests for, such as <strong>&ldquo;lambda-name-here.test.js</strong>&rdquo;.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.41.33.png"/>
</figure>

<p>Now head to package.json and create a new script to run our integration tests.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.45.28.png"/>
</figure>

<p>Next letâ€™s look at our integration test file, which includes our first test.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.54.39.png"/>
</figure>

<p>We begin by creating a localhost url and port string, which we pass into Supertest when we import it into te file. Jest uses a familiar &ldquo;describe&rdquo; block, with &ldquo;it&rdquo; blocks inside of it. We are using Supertest to execute an HTTP Post request, which includes are body of JSON data to execute against our Lambda API endpoint. The callback inside the .then will be handled by Jest, so we can use any of the Jest expect methods in that callback.</p>
<h3 id="running-our-integration-tests">Running Our Integration Tests</h3>
<p>Firstly, run the &ldquo;serverless offline&rdquo; command, so that we can test our API locally.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.55.11.png"/>
</figure>

<p>Now run our integration test script &ldquo;npm run integration&rdquo;.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.55.23.png"/>
</figure>

<p>Here&rsquo;s the result of our integration test, which has successfully passed.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.56.26.png"/>
</figure>

<p>Let&rsquo;s add a few more integration tests to validate different scenarios, and review the results.</p>
<figure><img src="/images/2020/08/Screenshot-2020-08-16-at-17.57.43-1.png"/>
</figure>

<p>As you can see, all of our integration tests with Jest are passing successfully, and our Lambda API endpoint is good to go! Enjoy!</p>
<h2 id="download-github-code-sample">Download Github Code Sample</h2>
<p>Feel free to <strong><a href="https://github.com/sahgilbert/portfolio-integration-testing-typescript-lambda-jest">DOWNLOAD</a></strong> the sample code of the aforementioned implementation from my Github account.</p>


                            
                            
                            
                            
                            
                        </section>

					</div>

                    

<footer id="footer">
    
    <section class="split contact">
        
        
        
        
        <section>
            <h3>Social</h3>
            <ul class="icons alt">
                
                
                
                
                
                <li><a href="https://github.com/sahgilbert" class="icon alt fa-github"><span class="label">GitHub</span></a></li>
                
                
                
                
                
            </ul>
        </section>
        
    </section>
</footer>

                    
<div id="copyright">
    <ul><li>&copy; Simon Gilbert</li><li><a href="https://www.github.com/sahgilbert">Github</a></li><li><a href="https://simongilbert.net">Blog Home Page</a></li></ul>
</div>


            </div>
            
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-136163864-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
            










<script src='/assets/js/bundle.js'></script>


	</body>
</html>
